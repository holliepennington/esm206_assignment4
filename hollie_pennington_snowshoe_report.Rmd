---
title: "ESM 206 A3 Task2"
author: "Hollie Pennington"
date: "11/4/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include = FALSE, warnings = FALSE, echo = FALSE, messages = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
#install packages
library(here)
library(tidyverse)
library(janitor)
library(lubridate)
library(kableExtra)
library(effsize)
```

#Introduction: The report shows a comparison between of weight for juvenile snowshoe hares, Lepus americanus. Weight is compared by sex and site and is compared to the size of hind feet. Samples were collected in Alasksa from the Tanana valley between the years 1999 and 2012. Weight is compared by site and sex (Kiellend et al. 2017). 

##Data and analyses: The data in this exploratory report was accumulated by Kiellend et al. 2017. To analys and compare data I used bar graphs, box plots, and linear regression visuals, along with exploratoy histograms and qq plots that are not depicted. To find stastical relevance I tested for means, standard deviations, R2, cohen's D, unpaired two-sample t-tests, and Pearson's r correlation. 

```{r}
snowshoe <- read_csv(here("data","bonanza_hares.csv")) %>% 
  clean_names() %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))
#read in data 
#made a year column using mutate
```

```{r}
j_snowshoe <- snowshoe %>% 
  filter(age == "j") %>% 
  group_by(age, year) %>% 
  summarise(total = n()) 
#created new data frame including only juvenile hares and they are grouped by age and year. 
```

```{r}
ggplot(data = j_snowshoe, aes(x = year, y = total)) + 
  geom_col() + 
  labs(title = "Annual juvenile hare trap count", x = "Year", y = "Total number of juvenile hares") + 
  theme_test()
#created bar graph comparing year to the number of hares trapped 
```

<b> Figure 1: </b> This graph above represents the total number of juvenile hare trappings from year 1998 to 2012. The year with the most trappings is 1999. The year with the least trappings is 2010.     

#Data analysis: The minimum amount of snowshoes that were found in one single year was 2. The highest number of snowshoes found in one year was 126. The median amount of snowshoes being trapped throughout the years is 18.5. The mean amount of hares trapped every year was 12. I suspect that there are confounding factors such as effort, number of traps, and hare location at play that inpacted the data. In future studies the confouding factors can be reduced by making sure all human efforts and methods are consistent throughout the years. 


```{r}
j_snowshoe_stats <- j_snowshoe %>% 
  summarise(minimum = min(total), 
            maximum = max(total), 
            mean = mean(total, ra.nm = TRUE), 
            median = median(total, ra.nm = TRUE), 
            total = n())
#found stats for variables with juvenile hare data frame 
```

#Juvenile Hare Weights 

```{r}
weights_j_snowshoe <- snowshoe %>% 
  filter(age == "j") %>% 
  select(age, weight, grid, sex) %>% 
   mutate(sex = case_when(
    sex == "f" ~ "Female", 
    sex == "m" ~ "Male",
    sex == "FALSE" ~ "Unknown")) %>% 
  mutate(grid = case_when(
    grid == "bonbs" ~ "Bonbs", 
    grid == "bonmat" ~ "Bonmat", 
    grid == "bonrip" ~ "Bonrip"
  )) %>% #changed names 
  group_by(sex, weight, grid, age) %>% 
  summarise(total = n())
#created new data frame for juvenile hare that includes age, weight, grid, and sex
```

```{r, include = FALSE}
#Attempted visualization, did not like graph, not including in knitted document but I worked really hard on this and don't want to delete it in case I need the reference later
ggplot(data = weights_j_snowshoe, aes(y = weight, x = total, fill = sex)) + 
  geom_col(position = position_dodge()) + #created graph
  facet_wrap(~ grid) + #faceted by grid
  labs(title = "Juvenile snowshoe weight by site", 
       x = "Number of hares", 
       y = "Hare weight (g)",
       fill = "Sex") +
  theme(legend.position = c(0.9, 0.85), 
        legend.key.size = unit(0.3, 'cm'), 
        legend.text = element_text(size = 7), 
        legend.title = element_text(size = 8)) #changed graph visuals 
```

```{r}
ggplot(data = weights_j_snowshoe, aes(x = sex, y = weight, fill = sex)) + 
  geom_boxplot(show.legend = FALSE) + #created graph
  facet_wrap(~ grid) + #faceted by grid
  labs(title = "Comparing juvenile snowshoe weight and by site",
       x = "Sex", 
       y = "Weight (g)")+
  theme_get()
```

<b> FIGURE 2: </b> The above box plot represents hare weight (g) compared to hare sex. The data is divided by the three different sites Bonbs, Bonmat, Bonrip.   

#Analyses: The median weight for male snowshoe hares in larger than the median wieght for female snowshoe hares. In the Bonbs site and the Bonmat site there is a larger varaince in female wieght then there is in male weight.   

#Juvenile hare weight comparison (male & female snowshoe hares)


```{r}
stats_snowshoe <- weights_j_snowshoe %>% 
  select(sex) %>% 
  group_by(sex) %>% 
  summarise(mean = mean(weight, na.rm = TRUE),
            standard_deviation = sd(weight, na.rm = TRUE),
            sample_size = n())
#created new data frame with statistics on j hare weights 
```

```{r}
stats_snowshoe %>% 
kable(col.name = c("Sex", "Mean Weight (g)", "Standard Deviation (g)", "Sample Size"), #created graph
      caption = "<b> Table 1: </b> The table below shows the difference between mean female hare weight (g) and mean male hare weight(g). Males have a higher mean weight by 81.63 grams.") %>%  #added caption 
  kable_styling(full_width = FALSE)
#created visual on snowshoe statistics 
```

```{r, include = FALSE}
ggplot(data = weights_j_snowshoe, aes(x = weight)) + 
  geom_histogram(bins = 15) + 
  facet_wrap(~ sex)

ggplot(data = weights_j_snowshoe, aes(sample = weight)) + 
  geom_qq() + 
  facet_wrap(~ sex)
#visualize data to see if we can run statistical testing. 
#based on outcome of graphs and number of samples, I feel confident that I can do a t-test. 
```

```{r, include = FALSE}
f_hare <- weights_j_snowshoe %>% 
  filter(sex == "Female") %>% 
  pull(weight)

m_hare <- weights_j_snowshoe %>% 
  filter(sex == "Male") %>% 
  pull(weight)

ttest_j_hare <- t.test(f_hare, 
                       m_hare)
ttest_j_hare

cd_j_hare <- cohen.d(f_hare,
                     m_hare, 
                     na.rm = TRUE)

cd_j_hare
```
 
Data analysis: Mean weight for female juvenile snowshoe hare ('r round(f_hare$estimate[1],2)'g) is less than that of male juvenile snowshoe hares by ('r round(m_hare$estimate[2],2)'g). The effect size is very small (Cohen's *d* = 'r round(cd_j_hare)') and difference sigificant (two-sample t-test, t = 'r round (ttest_j_hare,2)' p < 0.05).


#Relationship between juvenile weight and hind foot length 

```{r}
j_snowshoes <- snowshoe %>% 
  filter(age == "j") %>% 
  group_by(weight, hindft) %>% 
  summarise(total = n())
#created new data frame to help compare weight by hind feet
```

```{r}
#relationship between juvenile weight and hind foot length
ggplot(data = j_snowshoes, aes(y = weight, x = hindft)) + 
  geom_jitter() + #created graph
  labs(title = "Juvenile hares weight vs hindfeet", x = "Hindfeet Length (mm)", y = "Weight (g)") #edited graph labels 
```

<b> Figure 3: </b> The above graph shows a positive correlation between weight (g) and hind feet (mm) in juvenile snowshoe hares. 

#Linear regression: 

```{r, include = FALSE}
#linear regression 
lm_j_snowshoes <- lm(hindft ~ weight, data = j_snowshoes)
lm_j_snowshoes
summary(lm_j_snowshoes)
```
Analysis: 

```{r, include = FALSE}
plot(lm_j_snowshoes)
```

##Summary: I found that there is a decline in population of snow shoe hares. Male snowshoe hares on average have a larger weight than female snowshoe hares. There is a positive correlation between weight and hindfeet. 

###Citation: 
Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14 (Accessed 2021-11-10). 
